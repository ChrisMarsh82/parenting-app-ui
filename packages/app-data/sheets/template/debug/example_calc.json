{
  "flow_type": "template",
  "flow_subtype": "debug",
  "flow_name": "example_calc",
  "status": "released",
  "rows": [
    {
      "type": "title",
      "name": "example_1",
      "value": "Calc JS Functions",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "example_calc_1",
      "value": "@calc(Math.floor(Math.random()*7))",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "example_calc_2",
      "value": "@local.example_calc_1 + 1",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "example_calc_3",
      "value": "@calc(Math.ceil(Math.random()*3))",
      "_translations": {
        "value": {}
      },
      "condition": "!@local.example_calc_3"
    },
    {
      "type": "text",
      "name": "text_1",
      "value": "calc_1: @local.example_calc_1\ncalc_2: @local.example_calc_2\ncalc_3: @local.example_calc_3   (fixed)",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "example_calc_max",
      "value": "@calc(Math.max(@local.example_calc_1,@local.example_calc_2,@local.example_calc_3))",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "text",
      "name": "text_2",
      "value": "The largest number is: @local.example_calc_max",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "title",
      "name": "example_2",
      "value": "Calc Custom Functions",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "subtitle",
      "name": "example_2.1",
      "value": "Calc Pick Random Array Item",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "list_data",
      "value": "@data.example_calc.example_1.value_list",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "random_item",
      "value": "@calc(pick_random(@local.list_data))",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "text",
      "name": "text_3",
      "value": "Random Item: @local.random_item.name",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "button",
      "name": "button_1",
      "value": "Randomise",
      "_translations": {
        "value": {}
      },
      "action_list": [
        {
          "trigger": "click",
          "action_id": "emit",
          "args": [
            "force_reprocess"
          ],
          "_raw": "click | emit:force_reprocess",
          "_cleaned": "click | emit:force_reprocess"
        }
      ]
    },
    {
      "type": "subtitle",
      "name": "example_2.2",
      "value": "Calc Lookup Text",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "radio_group",
      "name": "selected_item",
      "action_list": [
        {
          "trigger": "changed",
          "action_id": "emit",
          "args": [
            "force_reprocess"
          ],
          "_raw": "changed | emit:force_reprocess",
          "_cleaned": "changed | emit:force_reprocess"
        }
      ],
      "parameter_list": [
        "answer_list: @local.list_data"
      ]
    },
    {
      "type": "set_variable",
      "name": "selected_item_text",
      "value": "@calc(lookup_answer_list(@local.list_data,@local.selected_item))",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "text",
      "name": "text_2.2a",
      "value": "Selected name: @local.selected_item",
      "_translations": {
        "value": {}
      },
      "condition": "@local.selected_item"
    },
    {
      "type": "text",
      "name": "text_2.2b",
      "value": "Selected text: @local.selected_item_text",
      "_translations": {
        "value": {}
      },
      "condition": "@local.selected_item"
    },
    {
      "type": "title",
      "name": "example_3",
      "value": "Calc Date Utilities",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "date_now",
      "value": "@calc(now())",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "text",
      "name": "text_3.1a",
      "value": "Today is @local.date_now",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "timestamp",
      "value": "@calc(timestamp())",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "text",
      "name": "text_3.1b",
      "value": "This is a db-friendly timestamp: @local.timestamp",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "date_formatted",
      "value": "@calc(window.date_fns.format(now(),\"dd MMM yyyy\"))",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "text",
      "name": "text_3.1c",
      "value": "Formatted: @local.date_formatted",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "start_of_week",
      "value": "@calc(window.date_fns.startOfWeek(now(),{ weekStartsOn: 1 }))",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "start_of_week_text",
      "value": "The week started on @local.start_of_week",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "days_to_xmas",
      "value": "@calc(window.date_fns.differenceInDays(new Date(\"2021-12-25\"),now()))",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "text",
      "name": "text_3.2",
      "value": "There are @local.days_to_xmas days to Christmas (2021)",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "set_variable",
      "name": "last_xmas_words",
      "value": "@calc(window.date_fns.formatDistance(new Date(\"2020-12-25\"),now(),{ addSuffix: true }))",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "text",
      "name": "text_3.3",
      "value": "The last christmas was @local.last_xmas_words",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "title",
      "name": "example_4",
      "value": "Calc Context Variables",
      "_translations": {
        "value": {}
      }
    },
    {
      "name": "app_day",
      "value": "@calc(this.app_day)",
      "_translations": {
        "value": {}
      }
    },
    {
      "name": "app_first_launch",
      "value": "@calc(this.app_first_launch)",
      "_translations": {
        "value": {}
      }
    },
    {
      "name": "app_user_id",
      "value": "@calc(this.app_user_id)",
      "_translations": {
        "value": {}
      }
    },
    {
      "name": "device_os",
      "value": "@calc(this.device_info.operatingSystem)",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "text",
      "name": "text_4.1",
      "value": "The current app day is @local.app_day",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "text",
      "name": "text_4.2",
      "value": "The app was first launched on @local.app_first_launch",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "text",
      "name": "text_4.3",
      "value": "The current user id is @local.app_user_id",
      "_translations": {
        "value": {}
      }
    },
    {
      "type": "text",
      "name": "text_4.4",
      "value": "The device OS is @local.device_os",
      "_translations": {
        "value": {}
      }
    }
  ],
  "_xlsxPath": "quality_assurance/example_sheets/to_be_sorted/example_calc.xlsx"
}